{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://representapp.example.com/schemas/api-response.json",
  "title": "Representatives API Response",
  "description": "Schema for the GET /representatives API endpoint response with nested government level grouping",
  "type": "object",
  "oneOf": [
    {
      "$ref": "#/definitions/ApiSuccessResponse"
    },
    {
      "$ref": "#/definitions/ApiErrorResponse"
    }
  ],
  "definitions": {
    "ApiSuccessResponse": {
      "type": "object",
      "required": ["representatives", "metadata"],
      "properties": {
        "representatives": {
          "$ref": "#/definitions/GovernmentLevelGroup"
        },
        "metadata": {
          "$ref": "#/definitions/Metadata"
        },
        "warnings": {
          "type": "array",
          "description": "Optional array of warning messages about data limitations",
          "items": {
            "type": "string",
            "minLength": 1
          }
        }
      },
      "additionalProperties": false
    },
    "ApiErrorResponse": {
      "type": "object",
      "required": ["error"],
      "properties": {
        "error": {
          "type": "object",
          "required": ["code", "message"],
          "properties": {
            "code": {
              "type": "string",
              "description": "Machine-readable error code",
              "examples": ["INVALID_ADDRESS", "GEOCODING_FAILED", "EXTERNAL_API_ERROR"]
            },
            "message": {
              "type": "string",
              "description": "Human-readable error message",
              "minLength": 1
            },
            "details": {
              "type": "string",
              "description": "Optional technical details for debugging"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "GovernmentLevelGroup": {
      "type": "object",
      "description": "Representatives grouped by government level",
      "required": ["federal", "state", "local"],
      "properties": {
        "federal": {
          "type": "array",
          "description": "Federal-level representatives (senators, house members, president, etc.)",
          "items": {
            "$ref": "#/definitions/Representative"
          }
        },
        "state": {
          "type": "array",
          "description": "State-level representatives (governors, state legislators, etc.)",
          "items": {
            "$ref": "#/definitions/Representative"
          }
        },
        "local": {
          "type": "array",
          "description": "Local-level representatives (mayors, city council, county supervisors, etc.)",
          "items": {
            "$ref": "#/definitions/Representative"
          }
        }
      },
      "additionalProperties": false
    },
    "Representative": {
      "type": "object",
      "required": ["id", "name", "office", "government_level", "jurisdiction"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier (OCD ID format)",
          "pattern": "^ocd-.*",
          "examples": ["ocd-division/country:us/state:ca"]
        },
        "name": {
          "type": "string",
          "description": "Full name of the representative",
          "minLength": 1,
          "examples": ["Nancy Pelosi", "John Smith"]
        },
        "office": {
          "type": "string",
          "description": "Official title or office held",
          "minLength": 1,
          "examples": ["U.S. Senator", "State Representative", "City Council Member"]
        },
        "party": {
          "type": ["string", "null"],
          "description": "Political party affiliation",
          "examples": ["Democratic", "Republican", "Independent", null]
        },
        "government_level": {
          "type": "string",
          "enum": ["federal", "state", "local"],
          "description": "Level of government where this official serves"
        },
        "jurisdiction": {
          "type": "string",
          "description": "Geographic area or district represented",
          "minLength": 1,
          "examples": ["California's 11th District", "Washington State", "District of Columbia"]
        },
        "email": {
          "type": ["string", "null"],
          "format": "email",
          "description": "Official email address"
        },
        "phone": {
          "type": ["string", "null"],
          "description": "Official phone number",
          "examples": ["(202) 555-0100", "555-0100"]
        },
        "address": {
          "type": ["string", "null"],
          "description": "Physical office address",
          "examples": ["123 Capitol St, Washington DC 20001"]
        },
        "website": {
          "type": ["string", "null"],
          "format": "uri",
          "description": "Official website URL",
          "examples": ["https://example.gov", "https://senator.gov"]
        },
        "photo_url": {
          "type": ["string", "null"],
          "format": "uri",
          "description": "URL to official photograph",
          "examples": ["https://cdn.example.com/photos/rep123.jpg"]
        }
      },
      "additionalProperties": false
    },
    "Metadata": {
      "type": "object",
      "required": ["address", "total_count", "government_levels"],
      "properties": {
        "address": {
          "type": "string",
          "description": "Normalized/resolved address that was searched",
          "minLength": 1,
          "examples": ["1600 Pennsylvania Avenue NW, Washington, DC 20500"]
        },
        "coordinates": {
          "type": ["object", "null"],
          "description": "Geographic coordinates of the address (optional)",
          "required": ["latitude", "longitude"],
          "properties": {
            "latitude": {
              "type": "number",
              "minimum": -90,
              "maximum": 90,
              "description": "Latitude coordinate"
            },
            "longitude": {
              "type": "number",
              "minimum": -180,
              "maximum": 180,
              "description": "Longitude coordinate"
            }
          },
          "additionalProperties": false
        },
        "total_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of representatives across all government levels"
        },
        "government_levels": {
          "type": "array",
          "description": "List of government levels with at least one representative",
          "items": {
            "type": "string",
            "enum": ["federal", "state", "local"]
          },
          "uniqueItems": true,
          "examples": [["federal", "state"], ["federal", "state", "local"], []]
        },
        "response_time_ms": {
          "type": "integer",
          "minimum": 0,
          "description": "Backend processing time in milliseconds (optional)"
        }
      },
      "additionalProperties": false
    }
  }
}
